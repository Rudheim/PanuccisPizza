!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=2)}([function(e,t,n){"use strict";function o(e,t){var n=document.querySelector("#".concat(e)),o=t;M.Modal.getInstance(n).close(),o.reset()}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return i}));var a=function(){document.querySelectorAll(".icons").forEach((function(e){e.addEventListener("mouseover",(function(e){e.target.parentElement.classList.add("pulse")})),e.addEventListener("mouseout",(function(e){e.target.parentElement.classList.remove("pulse")}))}))};function i(e){M.updateTextFields(),M.textareaAutoResize(e)}document.addEventListener("DOMContentLoaded",(function(e){var t=document.querySelector("select");M.FormSelect.init(t)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".scrollspy");M.ScrollSpy.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".sidenav");M.Sidenav.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".parallax");M.Parallax.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".modal");M.Modal.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".tabs");M.Tabs.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{closeOnClick:!0,hover:!0,coverTrigger:!1})})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".collapsible");M.Collapsible.init(e)}))},,function(e,t,n){"use strict";n.r(t),n.d(t,"setupUI",(function(){return z}));var o=n(0),a=db.collection("users");auth.onAuthStateChanged((function(e){e&&e.getIdTokenResult().then((function(t){e.admin=t.claims.admin,a.doc(e.uid).get().then((function(t){z(e,t)}))}))}));var i=document.querySelector("#signup-form");i.addEventListener("submit",(function(e){e.preventDefault();var t=i["signup-email"].value,n=i["signup-password"].value;auth.createUserWithEmailAndPassword(t,n).then((function(e){return a.doc(e.user.uid).set({name:i.nickname.value})})).then((function(){Object(o.a)("modal-signup",i)})).catch((function(e){return console.log(e.message)}))}));var r=document.querySelector("#login-form");r.addEventListener("submit",(function(e){e.preventDefault();var t=r["login-email"].value,n=r["login-password"].value;auth.signInWithEmailAndPassword(t,n).then((function(e){Object(o.a)("modal-login",r)})).catch((function(e){return console.log(e.message)}))})),document.querySelector("#logout").addEventListener("click",(function(e){e.preventDefault(),auth.signOut().then((function(){location.reload()}))}));var c=document.querySelector(".admin-actions");c.addEventListener("submit",(function(e){e.preventDefault();var t=document.querySelector("#admin-email").value;functions.httpsCallable("addAdminRole")({email:t}).then((function(e){console.log(e)})),Object(o.a)("modal-account",c)}));var d=db.collection("pizzas"),l=document.querySelector("#pizza-list"),u=function(e){var t="\n      <tr pizza-id=".concat(e.id,'>\n        <td><i href="#modal_edit" class="material-icons delete green-text darken-1-text modal-trigger">edit</i></td>\n        <td>').concat(e.data().title,"</td>\n        <td>").concat(e.data().price,'</td>\n        <td><i class="material-icons delete red-text darken-1-text">delete</i></td>\n      </tr>\n    ');l.innerHTML+=t},s=function(e,t){var n=document.querySelector("#".concat(e)).files[0];if(n){var o=Math.floor(999*Math.random())+n.name,a={contentType:n.type};storage.ref().child(o).put(n,a).then((function(e){e.ref.getDownloadURL().then((function(e){t.src=e}))})).catch((function(e){return console.log(e.message)}))}else console.log("You need to choose a file first")},m=document.querySelector("#addPizza"),f=document.querySelector("#upload-btn"),g=document.querySelector("#img-create");f.addEventListener("click",(function(e){e.preventDefault(),s("file-create",g)})),m.addEventListener("submit",(function(e){e.preventDefault(),d.add({title:m.title.value,price:parseInt(m.price.value),vegan:y(m.vegan.value),img:g.src,description:m.description.value}).then((function(){Object(o.a)("modal_create",m)})).catch((function(e){console.log(e.message)}))}));var p=document.querySelector("#pizzaList"),v=document.querySelector("#editPizza"),h=document.querySelector("#img-edit");p.addEventListener("click",(function(e){if("I"===e.target.tagName&&"edit"==e.target.textContent){var t=e.target.parentElement.parentElement.getAttribute("pizza-id");d.doc(t).get().then((function(e){v.disabled.value=t,v["edit-title"].value=e.data().title,v["edit-price"].value=e.data().price,v["vegan-edit"].value=e.data().vegan,v["edit-description"].value=e.data().description,h.src=e.data().img,Object(o.c)(v["edit-description"])})).catch((function(e){console.log(e.message)}))}})),document.querySelector("#upload-btn-edit").addEventListener("click",(function(e){e.preventDefault(),s("file-edit",h)})),v.addEventListener("submit",(function(e){e.preventDefault();var t=v.disabled.value;d.doc(t).set({title:v["edit-title"].value,price:parseInt(v["edit-price"].value),vegan:y(v["vegan-edit"].value),img:h.src,description:v["edit-description"].value}).then((function(){Object(o.a)("modal_edit",v)})).catch((function(e){console.log(e.message)}))})),p.addEventListener("click",(function(e){if("I"===e.target.tagName&&"delete"==e.target.textContent){var t=e.target.parentElement.parentElement.getAttribute("pizza-id");d.doc(t).delete().then((function(){console.log("item deleted")})).catch((function(e){console.error("Error removing document: ",e)}))}}));var y=function(e){return"true"==e},b=db.collection("ingredients"),E=document.querySelector("#ing_list"),_=function(e){var t="\n    <tr ingredient-id=".concat(e.id,'>\n      <td><i href="#modal_edit_ingredient" class="material-icons delete green-text darken-1-text modal-trigger">edit</i></td>\n      <td>').concat(e.data().name,"</td>\n      <td>").concat(e.data().price,'</td>\n      <td><i class="material-icons delete red-text darken-1-text">delete</i></td>\n    </tr>\n  ');E.innerHTML+=t},S=document.querySelector("#addIngredientForm");S.addEventListener("submit",(function(e){e.preventDefault(),b.add({name:S.ing_name.value,price:parseInt(S.ing_price.value),description:S.ing_description.value}).then((function(){Object(o.a)("modal_create_ingredient",S)})).catch((function(e){console.log(e.message)}))}));var L=document.querySelector("#IngredientList"),q=document.querySelector("#editIngredientForm");L.addEventListener("click",(function(e){if("I"===e.target.tagName&&"edit"==e.target.textContent){var t=e.target.parentElement.parentElement.getAttribute("ingredient-id");b.doc(t).get().then((function(e){q.disabled_ing.value=t,q.ing_name_edit.value=e.data().name,q.ing_price_edit.value=e.data().price,q.ing_description_edit.value=e.data().description,Object(o.c)(q.ing_description_edit)})).catch((function(e){console.log(e.message)}))}})),q.addEventListener("submit",(function(e){e.preventDefault();var t=q.disabled_ing.value;b.doc(t).set({name:q.ing_name_edit.value,price:parseInt(q.ing_price_edit.value),description:q.ing_description_edit.value}).then((function(){Object(o.a)("modal_edit_ingredient",q)})).catch((function(e){console.log(e.message)}))})),L.addEventListener("click",(function(e){if("I"===e.target.tagName&&"delete"==e.target.textContent){var t=e.target.parentElement.parentElement.getAttribute("ingredient-id");b.doc(t).delete().then((function(){console.log("item deleted")})).catch((function(e){console.error("Error removing document: ",e)}))}}));var x=db.collection("orders"),O=document.querySelector("#order_list"),I=function(){x.orderBy("date","desc").onSnapshot((function(e){O.innerHTML="",e.docs.forEach((function(e){D(e)}))}))},D=function(e){var t=[],n=[];e.data().order.forEach((function(e){(e.includes("Custom")?n:t).push(e)}));var o=dateFns.distanceInWordsToNow(e.data().date.toDate(),{addSuffix:!0}),a=dateFns.format(e.data().date.toDate(),"DD/MM/YYYY HH:mm:ss"),i="light-blue-text text-accent-3",r="blue";"order-completed"==e.data().status&&(i="green-text text-darken-3",r="green");var c="\n    <li order-id=".concat(e.id,'>\n    <div class="collapsible-header">\n      <span>').concat(o,'</span>\n      <a class="right btn-floating btn-small waves-effect waves-light ').concat(r,'"><i class="material-icons">check</i></a>\n      <span class="right ').concat(i,'">').concat(e.data().status,'</span>\n    </div>\n      <div class="collapsible-body">\n      <p class="grey-text">UserID: ').concat(e.data().user_id,"</p>\n      <p>Exact time: ").concat(a,'</p>\n      <p class="bold_font">Name: ').concat(e.data().name,'</p>\n      <p class="green-text bold_font underline">Total cost: ').concat(e.data().total_cost,' $</p>\n      <p class="orange-text">Pizzas:</p>\n      <ul>\n      ').concat(t.map((function(e){return"<li> -"+e+"</li>"})).join(""),'\n      </ul>\n      <p class="orange-text text-darken-4">Custom pizzas:</p>\n      <ul>\n      ').concat(n.map((function(e){return"<li> -"+e+"</li>"})).join(""),"\n      </ul>\n      </div>\n    </li>\n    ");O.innerHTML+=c};function k(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}O.addEventListener("click",(function(e){if("I"===e.target.tagName){var t=e.target.parentElement.parentElement.parentElement.getAttribute("order-id");x.doc(t).update({status:"order-completed"}).then((function(){I(),console.log("order "+t+" completed")})).catch((function(e){return console.log(e.message)}))}}));var A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.loggedOutElem=document.querySelectorAll(".logged-out"),this.loggedInElem=document.querySelectorAll(".logged-in"),this.adminItems=document.querySelectorAll(".admin"),this.accountIcon=document.querySelector("#account_icon"),this.accountDetails=document.querySelector(".account-details"),this.user_profile=document.querySelector("#user_profile"),this.greeting_msg=document.querySelector("#greeting")}var t,n,o;return t=e,(n=[{key:"logedIn",value:function(e,t){this.loggedInElem.forEach((function(e){"LI"==e.tagName?e.style.display="list-item":e.style.display="block"})),this.loggedOutElem.forEach((function(e){return e.style.display="none"})),this.accountIcon.style.color="#ff6f00",this.user_profile.profile_id.value=e.uid,this.user_profile.profile_name.value=t.data().name,this.user_profile.profile_email.value=e.email,this.accountDetails.value=e.admin?"Admin":"User",M.updateTextFields(),this.greeting_msg.textContent="Hi, ".concat(t.data().name)}},{key:"AdminUI",value:function(){this.adminItems.forEach((function(e){return e.style.display="block"})),d.onSnapshot((function(e){l.innerHTML="",e.docs.forEach((function(e){u(e)}))})),b.onSnapshot((function(e){E.innerHTML="",e.docs.forEach((function(e){_(e)}))})),I()}},{key:"logedOut",value:function(){location.reload()}}])&&k(t.prototype,n),o&&k(t,o),e}(),z=function(e,t){var n=new A;e?(e.admin&&n.AdminUI(),n.logedIn(e,t)):n.logedOut()}}]);