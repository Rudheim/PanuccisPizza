!function(e){var t={};function n(o){if(t[o])return t[o].exports;var a=t[o]={i:o,l:!1,exports:{}};return e[o].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)n.d(o,a,function(t){return e[t]}.bind(null,a));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";function o(e,t){var n=document.querySelector("#".concat(e)),o=t;M.Modal.getInstance(n).close(),o.reset()}n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return r}));var a=function(){document.querySelectorAll(".icons").forEach((function(e){e.addEventListener("mouseover",(function(e){e.target.parentElement.classList.add("pulse")})),e.addEventListener("mouseout",(function(e){e.target.parentElement.classList.remove("pulse")}))}))};function r(e){M.updateTextFields(),M.textareaAutoResize(e)}document.addEventListener("DOMContentLoaded",(function(e){var t=document.querySelector("select");M.FormSelect.init(t)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".scrollspy");M.ScrollSpy.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelector(".sidenav");M.Sidenav.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".parallax");M.Parallax.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".modal");M.Modal.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".tabs");M.Tabs.init(e)})),document.addEventListener("DOMContentLoaded",(function(){var e=document.querySelectorAll(".dropdown-trigger");M.Dropdown.init(e,{closeOnClick:!0,hover:!0,coverTrigger:!1})}))},function(e,t,n){"use strict";n.r(t),n.d(t,"setupUI",(function(){return C}));var o=n(0),a=db.collection("users");auth.onAuthStateChanged((function(e){e?e.getIdTokenResult().then((function(t){e.admin=t.claims.admin,a.doc(e.uid).get().then((function(t){return C(e,t.data()),e.uid}))})).catch((function(e){console.log(e.message)})):C()}));var r=document.querySelector("#signup-form");r.addEventListener("submit",(function(e){e.preventDefault();var t=r["signup-email"].value,n=r["signup-password"].value;auth.createUserWithEmailAndPassword(t,n).then((function(e){a.doc(e.user.uid).set({name:r.nickname.value,shopping_cart:[]}),a.doc(e.user.uid).collection("user_orders").doc("self_made_pizza").set({ingredients:[]})})).then((function(){Object(o.a)("modal-signup",r)})).catch((function(e){return console.log(e.message)}))}));var c=document.querySelector("#login-form");c.addEventListener("submit",(function(e){e.preventDefault();var t=c["login-email"].value,n=c["login-password"].value;auth.signInWithEmailAndPassword(t,n).then((function(e){Object(o.a)("modal-login",c)})).catch((function(e){return console.log(e.message)}))})),document.querySelector("#logout").addEventListener("click",(function(e){e.preventDefault(),auth.signOut().then((function(){location.reload()}))}));var i=db.collection("pizzas"),d=document.querySelector("#menu");db.collection("orders");var l=document.querySelector("#shopping_cart_table"),u=document.querySelector("#shopping_cart_list"),s=document.querySelector(".badge"),f=document.querySelector("#profile_id");function p(e){a.doc(e).onSnapshot((function(e){var t,n,o;t=e.data(),n=[],o=0,u.innerHTML="",null==!t.shopping_cart?l.style.display="none":(s.textContent=t.shopping_cart.length,l.style.display="table",t.shopping_cart.forEach((function(e){var t=e.split(", "),a='\n      <tr position-id="'.concat(o,'">\n        <td>').concat(t[0],"</td>\n        <td>").concat(t[1],'</td>\n        <td><i class="material-icons delete red-text darken-1-text">delete</i></td>\n      </tr>\n      ');o++,n.push(parseInt(t[1])),m.textContent="Total: "+n.reduce((function(e,t){return e+t}),0)+" $",u.innerHTML+=a})))}))}var m=document.querySelector("#total_cost");d.addEventListener("click",(function(e){if("I"===e.target.tagName){var t=e.target.parentElement.parentElement.parentElement.getAttribute("pizza-id");db.runTransaction((function(e){return e.get(a.doc(f.value)).then((function(n){return e.get(i.doc(t)).then((function(t){var o=n.data().shopping_cart,r=t.data().title+", "+t.data().price;o.push(r),e.update(a.doc(f.value),{shopping_cart:o})})).then((function(){console.log("item have been added")})).catch((function(e){console.log(e.message)}))}))}))}})),u.addEventListener("click",(function(e){if("I"===e.target.tagName){var t=e.target.parentElement.parentElement.getAttribute("position-id");db.runTransaction((function(e){return e.get(a.doc(f.value)).then((function(n){var o=n.data().shopping_cart;o=o.filter((function(e,n){return e[n]!==e[t]})),e.update(a.doc(f.value),{shopping_cart:o})})).then((function(){p(f.value)})).catch((function(e){console.log(e.message)}))}))}}));var v=db.collection("ingredients"),g=document.querySelector("#ingredients-list"),h=function(){v.get().then((function(e){e.docs.forEach((function(e){!function(e){var t='<a ingredient-id="'.concat(e.id,'" class="collection-item">\n<span class="title black-text">').concat(e.data().name,'</span>\n<span class="secondary-content black-text">').concat(e.data().price,'$</span>\n<p class="grey-text text-darken-1">').concat(e.data().description,"</p>\n</a>");g.innerHTML+=t}(e)}))}))},y=document.querySelector("#create"),_=document.querySelector("#name"),b=document.querySelector("#modal_create_pizza"),L=document.querySelector("#create_pizza"),S=document.querySelector("select");y.addEventListener("submit",(function(e){e.preventDefault(),h();var t=new Date;a.doc(f.value).collection("user_orders").doc("self_made_pizza").set({created_at:firebase.firestore.Timestamp.fromDate(t),title:_.value,size:S.value,ingredients:[]}).then((function(e){console.log("Order created with ID")})).catch((function(e){console.error("Error adding document",e)})),y.classList.add("hidden"),L.classList.remove("hidden"),b.style.maxHeight="80%"}));var E=document.querySelector("#customer-list"),q=document.querySelector("#total");function x(){a.doc(f.value).collection("user_orders").doc("self_made_pizza").onSnapshot((function(e){!function(e){E.innerHTML="";var t=[],n=0;0===e.ingredients.length&&(q.textContent="",z.classList.add("hidden"));e.ingredients.forEach((function(e){var o=e.split(", "),a='\n    <a position-id="'.concat(n,'" class="collection-item">\n    <i class="material-icons delete red-text darken-1-text">delete</i>\n    <span class="title black-text">').concat(o[0],'</span>\n    <span class="secondary-content black-text">').concat(parseInt(o[1]),"$</span>\n    </a>\n    ");t.push(parseInt(o[1])),E.innerHTML+=a,n++,q.textContent=t.reduce((function(e,t){return e+t}),0)+"$",z.classList.remove("hidden"),E.classList.remove("hidden")})),a.doc(f.value).collection("user_orders").doc("self_made_pizza").update({total:t.reduce((function(e,t){return e+t}),0)})}(e.data())}))}g.addEventListener("click",(function(e){if("UL"!==e.target.nodeName){var t=e.target.getAttribute("ingredient-id");db.runTransaction((function(e){return e.get(a.doc(f.value).collection("user_orders").doc("self_made_pizza")).then((function(n){return e.get(v.doc(t)).then((function(t){var o=n.data().ingredients,r=t.data().name+", "+t.data().price;o.push(r),e.update(a.doc(f.value).collection("user_orders").doc("self_made_pizza"),{ingredients:o})})).then((function(){x()})).catch((function(e){console.log(e.message)}))}))}))}}));var z=document.querySelector("#order");z.addEventListener("click",(function(e){e.preventDefault(),db.runTransaction((function(e){return e.get(a.doc(f.value)).then((function(t){return e.get(a.doc(f.value).collection("user_orders").doc("self_made_pizza")).then((function(t){var n="Custom "+t.data().size+" "+t.data().title+", "+t.data().total+", "+t.data().ingredients;e.update(a.doc(f.value),{shopping_cart:firebase.firestore.FieldValue.arrayUnion(n)})})).then((function(){y.classList.remove("hidden"),L.classList.add("hidden"),b.style.maxHeight=""})).catch((function(e){console.log(e.message)}))}))}))})),E.addEventListener("click",(function(e){if("I"===e.target.tagName){var t=e.target.parentElement.getAttribute("position-id");a.doc(f.value).collection("user_orders").doc("self_made_pizza").get().then((function(e){var n=e.data().ingredients;n=n.filter((function(e,n){return e[n]!==e[t]})),a.doc(f.value).collection("user_orders").doc("self_made_pizza").update({ingredients:n}).then((function(){x()}))}))}}));var k=document.querySelector("#search");k.addEventListener("keyup",(function(){!function(e){Array.from(g.children).filter((function(t){return!t.textContent.toLowerCase().includes(e)})).forEach((function(e){return e.classList.add("hidden")})),Array.from(g.children).filter((function(t){return t.textContent.toLowerCase().includes(e)})).forEach((function(e){return e.classList.remove("hidden")}))}(k.value.trim().toLowerCase())})),i.get().then((function(e){e.docs.forEach((function(e){!function(e){var t=' \n  <div class="col s12 m6 l3">\n    <div pizza-id="'.concat(e.id,'" class="card" style="overflow: hidden;">\n      <div class="card-image">\n        <img src="').concat(e.data().img,'" class="activator">\n        <a class="halfway-fab btn-floating btn green"><i class="icons material-icons">shopping_basket</i></a>\n      </div>\n    <div class="card-content">\n      <p class=" center card-title activator grey-text text-darken-4">').concat(e.data().title,'</p>\n    </div>\n    <card-reveal class="card-reveal">\n      <span class="card-title grey-text text-darken-4"><i class="material-icons right">close</i>').concat(e.data().title,"</span>\n      <p>").concat(e.data().description,'</p>\n    </card-reveal>\n    <div class="card-action">\n      <p class="center-align">').concat(e.data().price," $</p>\n    </div>\n    </div>\n  </div>\n  ");d.innerHTML+=t}(e),Object(o.b)()}))}));var C=function(e,t){e&&(e.admin&&T.forEach((function(e){return e.style.display="block"})),function(e,t){O.forEach((function(e){"LI"==e.tagName?e.style.display="list-item":e.style.display="block"})),A.forEach((function(e){return e.style.display="none"})),D.style.color="#ff6f00",I.profile_id.value=e.uid,I.profile_name.value=t.name,I.profile_email.value=e.email,w.value=e.admin?"Admin":"User",M.updateTextFields(),j.textContent="Hi, ".concat(t.name),s.textContent=t.shopping_cart.length,p(e.uid)}(e,t))},A=document.querySelectorAll(".logged-out"),O=document.querySelectorAll(".logged-in"),T=document.querySelectorAll(".admin"),D=document.querySelector("#account_icon"),w=document.querySelector(".account-details"),I=document.querySelector("#user_profile"),j=document.querySelector("#greeting")}]);